# vi: ft=sh sts=2 ts=2 sw=2 et

set -o vi
set -o noclobber

if [[ "${BASH_VERSINFO}" -ge 4 ]]; then
  shopt -s checkjobs
  shopt -s dirspell
  shopt -u globstar
fi

shopt -s cdable_vars
shopt -s cdspell

shopt -s nocaseglob
shopt -s extglob
shopt -s dotglob

shopt -s cmdhist            # save multi-line commands in history as single line
shopt -s histappend         # do not overwrite history

shopt -s expand_aliases
shopt -s progcomp

shopt -s gnu_errfmt
shopt -s checkwinsize       # update the value of LINES and COLUMNS after each command if altered

source_if_exists () {
  if [[ -f $1 ]]; then
    . $1
    return 0
  else
    return 1
  fi
}

. ~/.config/bash/git.bash
. ~/.config/bash/prompt.bash
. ~/.config/bash/aliases.bash
source_if_exists ~/.config/bash/os-aliases.bash
eval $(dircolors -b ~/.config/bash/dircolors/dircolors.256dark) 2>/dev/null >/dev/null

[[ -z "$HOSTNAME" ]] && HOSTNAME="$(hostname)"
HOSTIDENT="$(printf '%s' "$HOSTNAME" | sed 's/\..*//')"
source_if_exists ~/.config/bash/hosts/"${HOSTIDENT}.sh"
source_if_exists ~/.config/bash/hosts/"${HOSTIDENT}.private.sh"
source_if_exists ~/.config/bash/hosts/local.private.sh
unset HOSTIDENT

if [ -d ~/.fzf ]; then
  # Completion is bloody broken in fzf @ 45d4c57 
  # . ~/.fzf/shell/completion.bash 2>/dev/null
  . ~/.fzf/shell/key-bindings.bash 2>/dev/null
fi
. ~/.config/bash/buku-completion.bash
